{"version":3,"sources":["file:///Users/swayambhupanda/Documents/GitHub/applet-framework-demo/assets/MCQ/script/MCQ.ts"],"names":["Button","Component","Director","director","instantiate","Label","Layout","Prefab","_decorator","AS","ReplicatedButton","UIAnimationLibrary","ccclass","property","requireComponent","AnswerType","MCQ","type","String","_selection","Array","answer","awake","insertChild","insertButtonsComp","node","children","choiceButtons","map","child","btn","addComponent","forEach","i","name","on","EventType","CLICK","checkSelection","push","active","lableAssigner","optionsContainer","destroyAllChildren","optionLabel","length","addchild","optionPrefab","parent","once","EVENT_BEFORE_UPDATE","updateLayout","sel","checkFeedback","console","log","mcqLable","getComponentsInChildren","btnLable","string","statusIndex","Promise","all","status","flash"],"mappings":"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","sourcesContent":["import {\n  Button,\n  Component,\n  Director,\n  director,\n  instantiate,\n  Label,\n  Layout,\n  Prefab,\n  _decorator,\n} from \"cc\";\nimport { AS } from \"db://as_framework/scripts//ASComponent\";\nimport { ReplicatedButton } from \"db://as_framework/scripts/ReplicatedButton\";\nimport { UIAnimationLibrary } from \"db://as_framework/scripts/UIAnimLibrary\";\nconst { ccclass, property, requireComponent } = _decorator;\n\nenum AnswerType {\n  SINGLE_CORRECT,\n  MULTIPLE_CORRECT,\n}\n\n@ccclass(\"MCQ\")\nexport class MCQ extends AS(Component) {\n  @property({ type: String }) private optionLabel: string[] = [];\n\n  @property(Prefab) private optionPrefab: Prefab = null;\n\n  @property(Layout) private optionsContainer: Layout | null = null;\n\n  //@property({type: Enum(AnswerType)}) private answerType = AnswerType.SINGLE_CORRECT;\n\n  // @property({visible: function (this: MCQ) {return this.answerType === AnswerType.SINGLE_CORRECT}}) private x;\n  private _selection = Array<boolean>();\n\n  private answer = [false, true, true, false];\n\n  awake() {\n    this.insertChild();\n    const insertButtonsComp = this.node.children;\n\n    const choiceButtons = insertButtonsComp.map((child) => {\n      const btn = child.addComponent(Button);\n      child.addComponent(ReplicatedButton);\n\n      return btn;\n    });\n\n    choiceButtons.forEach((btn, i) => {\n      if (btn.node.name === \"check\") {\n        btn.node.on(Button.EventType.CLICK, () => {\n          this.checkSelection();\n        });\n\n        return;\n      }\n\n      this._selection.push(false);\n\n      btn.node.on(Button.EventType.CLICK, async () => {\n        if (this._selection[i] === false) {\n          btn.node.children[0].active = true;\n          this._selection[i] = true;\n        } else {\n          btn.node.children[0].active = false;\n          this._selection[i] = false;\n        }\n      });\n    });\n    this.lableAssigner();\n  }\n\n  insertChild() {\n    this.optionsContainer.node.destroyAllChildren();\n    for (let i = 0; i < this.optionLabel.length; i++) {\n      let addchild = instantiate(this.optionPrefab);\n      addchild.parent = this.optionsContainer.node;\n    }\n\n    director.once(Director.EVENT_BEFORE_UPDATE, () => this.optionsContainer.updateLayout());\n  }\n\n  checkSelection() {\n    this._selection.forEach((sel, i) => {\n      if (sel != this.answer[i]) {\n        this.checkFeedback(2);\n        return;\n      }\n    });\n    this.checkFeedback(1);\n    console.log(\"running\");\n  }\n\n  lableAssigner() {\n    const mcqLable = this.node.getComponentsInChildren(Label);\n    mcqLable.forEach((btnLable, i) => {\n      if (this.optionLabel.length <= i) {\n        btnLable.node.parent.active = false;\n      } else btnLable.string = this.optionLabel[i];\n    });\n  }\n\n  async checkFeedback(statusIndex) {\n    console.log(\"running\", this._selection);\n    const btn = this.node.children;\n\n    await Promise.all(\n      this._selection.map(async (status, i) => {\n        if (status) {\n          console.log(\"running\", statusIndex);\n          btn[i].children[statusIndex].active = true;\n          await UIAnimationLibrary.flash(btn[i].children[statusIndex], 2);\n          btn[i].children[statusIndex].active = false;\n        }\n      }),\n    );\n  }\n}\n"]}