{"version":3,"sources":["file:///Users/swayambhupanda/Documents/GitHub/applet-framework-demo/extensions/as_framework/framework/assets/scripts/UIAnim.ts"],"names":["Component","EventHandler","_decorator","AS","animController","editorUtils","UIAnimationLibrary","ccclass","property","UIAnim","type","tooltip","displayOrder","enumType","_controller","anim","_anim","duration","_duration","repeat","_repeat","playOnLoad","_playOnLoad","value","getName","play","_isAnimating","node","emit","EventType","ANIM_BEGIN","emitEvents","animBeginEvents","animFn","count","ANIM_END","animEndEvents","onEnable","onDisable","stop","Animations","Array"],"mappings":"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","sourcesContent":["import { Component, EventHandler, _decorator } from \"cc\";\nimport { AS } from \"./ASComponent\";\nimport { animController, AnimController, editorUtils, UIAnimationLibrary } from \"./UIAnimLibrary\";\nconst { ccclass, property } = _decorator;\n\n@ccclass(\"UIAnim\")\nexport class UIAnim extends AS(Component) {\n  static readonly Animations = editorUtils.enumType;\n\n  static readonly EventType = { ANIM_BEGIN: \"anim-begin\", ANIM_END: \"anim-end\" };\n\n  @property({\n    type: [EventHandler],\n    tooltip: \"The event handler to trigger on anim start.\",\n    displayOrder: 30,\n  })\n  animBeginEvents = new Array<EventHandler>();\n\n  @property({\n    type: [EventHandler],\n    tooltip: \"The event handler to trigger on anim complete.\",\n    displayOrder: 31,\n  })\n  animEndEvents = new Array<EventHandler>();\n\n  @property protected _anim: keyof typeof UIAnimationLibrary = \"none\";\n\n  @property protected _duration: number = 1;\n\n  @property protected _repeat: number = 0;\n\n  @property protected _playOnLoad = false;\n\n  protected _controller: AnimController | null = null;\n\n  @property({ type: editorUtils.enumType, tooltip: \"Choose animation.\" }) get anim() {\n    return editorUtils.enumType[this._anim];\n  }\n\n  @property({ tooltip: \"The animation duration.\" }) get duration() {\n    return this._duration;\n  }\n\n  @property({\n    tooltip: \"The number of times to repeat. If -1 will repeat infinitely until stop is called.\",\n  })\n  get repeat() {\n    return this._repeat;\n  }\n\n  @property get playOnLoad() {\n    return this._playOnLoad;\n  }\n\n  set anim(value) {\n    this._anim = editorUtils.getName(value);\n  }\n\n  set duration(value) {\n    this._duration = value;\n  }\n\n  set repeat(value) {\n    this._repeat = value;\n  }\n\n  set playOnLoad(value) {\n    this._playOnLoad = value;\n  }\n\n  async play() {\n    if (this._isAnimating) return;\n\n    this._controller = animController(this.node);\n    this._isAnimating = true;\n    this.node.emit(UIAnim.EventType.ANIM_BEGIN, this);\n    EventHandler.emitEvents(this.animBeginEvents, this);\n    const animFn = UIAnimationLibrary[this._anim];\n    let count = 0;\n    do {\n      await animFn(this._controller, this._duration);\n      count++;\n      // NOTE: possible infinite loop!!\n    } while (this.repeat === -1 || count <= this.repeat);\n\n    this._isAnimating = false;\n    this._controller = null;\n    this.node.emit(UIAnim.EventType.ANIM_END, this);\n    EventHandler.emitEvents(this.animEndEvents, this);\n  }\n\n  onEnable() {\n    if (this.playOnLoad) this.play();\n  }\n\n  onDisable() {\n    this.stop();\n  }\n\n  stop() {\n    if (!this._isAnimating || this._controller == null) return;\n\n    this._controller.stop();\n  }\n}\n"]}