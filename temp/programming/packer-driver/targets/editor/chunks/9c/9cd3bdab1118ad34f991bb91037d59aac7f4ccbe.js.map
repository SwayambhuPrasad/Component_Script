{"version":3,"sources":["file:///Users/swayambhupanda/Documents/GitHub/applet-framework-demo/extensions/as_framework/framework/assets/scripts/ReplicatedUIPopup.ts"],"names":["Component","EventHandler","_decorator","AS","error","networkReplicator","UIPopup","ccclass","disallowMultiple","requireComponent","ReplicatedUIPopup","constructor","_replicationIndex","_popup","registerEvent","awake","getComponent","node","on","EventType","ABOUT_TO_HIDE","_onAboutToHide","HIDE_COMPLETE","_onHideComplete","ABOUT_TO_SHOW","_onAboutToShow","SHOW_COMPLETE","_onShowComplete","onActivityEvent","name","data","emitEvents","aboutToHideEvents","emit","hideCompleteEvents","aboutToShowEvents","showCompleteEvents","getStateData","isVisible","updateStateData","show","hide","popup","isReplicated","sendEvent","id"],"mappings":"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","sourcesContent":["import { Component, EventHandler, _decorator } from \"cc\";\nimport { AS } from \"./ASComponent\";\nimport { error } from \"./Logger\";\nimport { IReplicatedEvent, networkReplicator } from \"./NetworkReplicator\";\nimport { UIPopup } from \"./UIPopup\";\n\nconst { ccclass, disallowMultiple, requireComponent } = _decorator;\n\n@ccclass(\"ReplicatedUIPopup\")\n@requireComponent(UIPopup)\n@disallowMultiple\nexport class ReplicatedUIPopup extends AS(Component) implements IReplicatedEvent {\n  private _replicationIndex: string;\n\n  private _popup: UIPopup | null = null;\n\n  constructor() {\n    super();\n    this._replicationIndex = networkReplicator.registerEvent(this);\n  }\n\n  awake() {\n    this._popup = this.getComponent(UIPopup);\n    if (this._popup == null) {\n      error(\"The replicated popup must be attached to a node with popup.\");\n      return;\n    }\n\n    this.node.on(UIPopup.EventType.ABOUT_TO_HIDE, this._onAboutToHide, this);\n    this.node.on(UIPopup.EventType.HIDE_COMPLETE, this._onHideComplete, this);\n    this.node.on(UIPopup.EventType.ABOUT_TO_SHOW, this._onAboutToShow, this);\n    this.node.on(UIPopup.EventType.SHOW_COMPLETE, this._onShowComplete, this);\n  }\n\n  onActivityEvent(name: string, data?: any): void {\n    if (this._popup == null) return;\n    switch (name) {\n      case UIPopup.EventType.ABOUT_TO_HIDE: {\n        EventHandler.emitEvents(this._popup.aboutToHideEvents, this._popup);\n        this.node.emit(UIPopup.EventType.ABOUT_TO_HIDE, this._popup, true);\n        break;\n      }\n\n      case UIPopup.EventType.HIDE_COMPLETE: {\n        EventHandler.emitEvents(this._popup.hideCompleteEvents, this._popup);\n        this.node.emit(UIPopup.EventType.HIDE_COMPLETE, this._popup, true);\n        break;\n      }\n\n      case UIPopup.EventType.ABOUT_TO_SHOW: {\n        EventHandler.emitEvents(this._popup.aboutToShowEvents, this._popup);\n        this.node.emit(UIPopup.EventType.ABOUT_TO_SHOW, this._popup, true);\n        break;\n      }\n\n      case UIPopup.EventType.SHOW_COMPLETE: {\n        EventHandler.emitEvents(this._popup.showCompleteEvents, this._popup);\n        this.node.emit(UIPopup.EventType.SHOW_COMPLETE, this._popup, true);\n        break;\n      }\n\n      default:\n        break;\n    }\n  }\n\n  getStateData() {\n    return this._popup?.isVisible;\n  }\n\n  updateStateData(data: boolean) {\n    if (this._popup == null) return;\n    if (data) {\n      this._popup.show();\n    } else {\n      this._popup.hide();\n    }\n  }\n\n  private _onAboutToHide(popup: UIPopup, isReplicated?: boolean) {\n    if (isReplicated) return;\n    networkReplicator.sendEvent({\n      id: this._replicationIndex,\n      name: UIPopup.EventType.ABOUT_TO_HIDE,\n    });\n  }\n\n  private _onHideComplete(popup: UIPopup, isReplicated?: boolean) {\n    if (isReplicated) return;\n    networkReplicator.sendEvent({\n      id: this._replicationIndex,\n      name: UIPopup.EventType.HIDE_COMPLETE,\n    });\n  }\n\n  private _onAboutToShow(popup: UIPopup, isReplicated?: boolean) {\n    if (isReplicated) return;\n    networkReplicator.sendEvent({\n      id: this._replicationIndex,\n      name: UIPopup.EventType.ABOUT_TO_SHOW,\n    });\n  }\n\n  private _onShowComplete(popup: UIPopup, isReplicated?: boolean) {\n    if (isReplicated) return;\n    networkReplicator.sendEvent({\n      id: this._replicationIndex,\n      name: UIPopup.EventType.SHOW_COMPLETE,\n    });\n  }\n}\n"]}